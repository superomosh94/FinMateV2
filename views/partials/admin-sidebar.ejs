<!-- views/partials/admin-sidebar.ejs -->
<style>
    .admin-sidebar {
        width: 280px;
        height: 100vh;
        background: linear-gradient(180deg, #2c3e50 0%, #34495e 100%);
        color: white;
        position: fixed;
        left: 0;
        top: 0;
        overflow-y: auto;
        box-shadow: 2px 0 10px rgba(0,0,0,0.1);
        z-index: 1000;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    .sidebar-header {
        padding: 20px;
        border-bottom: 1px solid #4a6278;
        background: rgba(0,0,0,0.1);
    }

    .sidebar-brand {
        display: flex;
        align-items: center;
        gap: 10px;
        font-size: 1.2rem;
        font-weight: bold;
        margin-bottom: 20px;
    }

    .sidebar-brand i {
        color: #3498db;
        font-size: 1.5rem;
    }

    .user-info {
        display: flex;
        align-items: center;
        gap: 12px;
    }

    .user-avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: #3498db;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.2rem;
    }

    .user-details .username {
        font-weight: 600;
        font-size: 0.9rem;
    }

    .user-details .user-role {
        font-size: 0.7rem;
        padding: 3px 8px;
        border-radius: 12px;
        background: <%= user.role === 'super_admin' ? '#e74c3c' : '#f39c12' %>;
    }

    .sidebar-nav {
        padding: 20px 0;
    }

    .nav-section {
        padding: 15px 20px 5px;
    }

    .section-label {
        font-size: 0.75rem;
        text-transform: uppercase;
        color: #bdc3c7;
        font-weight: 600;
        letter-spacing: 1px;
    }

    .nav-links {
        list-style: none;
        padding: 0;
        margin: 0;
    }

    .nav-item {
        margin: 5px 0;
    }

    .nav-link {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px 20px;
        color: #bdc3c7;
        text-decoration: none;
        transition: all 0.3s ease;
        position: relative;
        border-left: 3px solid transparent;
    }

    .nav-link:hover {
        background: rgba(255,255,255,0.1);
        color: white;
        border-left-color: #3498db;
    }

    .nav-link.active {
        background: rgba(52, 152, 219, 0.2);
        color: white;
        border-left-color: #3498db;
    }

    .nav-link i {
        width: 20px;
        text-align: center;
        font-size: 1.1rem;
    }

    .badge {
        margin-left: auto;
        font-size: 0.7rem;
        padding: 3px 6px;
        border-radius: 10px;
        background: #e74c3c;
        color: white;
    }

    .badge-warning {
        background: #f39c12;
    }

    .badge-danger {
        background: #e74c3c;
    }

    .logout-link {
        color: #e74c3c !important;
    }

    .logout-link:hover {
        background: rgba(231, 76, 60, 0.1) !important;
        border-left-color: #e74c3c !important;
    }

    .sidebar-footer {
        padding: 20px;
        border-top: 1px solid #4a6278;
        margin-top: auto;
    }

    .system-status {
        text-align: center;
    }

    .status-indicator {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        font-size: 0.8rem;
        margin-bottom: 8px;
    }

    .status-indicator.online i {
        color: #2ecc71;
        animation: pulse 2s infinite;
    }

    .server-time {
        font-size: 0.75rem;
        color: #95a5a6;
        font-family: 'Courier New', monospace;
    }

    @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.5; }
        100% { opacity: 1; }
    }

    /* Scrollbar Styling */
    .admin-sidebar::-webkit-scrollbar {
        width: 4px;
    }

    .admin-sidebar::-webkit-scrollbar-track {
        background: #34495e;
    }

    .admin-sidebar::-webkit-scrollbar-thumb {
        background: #3498db;
        border-radius: 2px;
    }

    .admin-sidebar::-webkit-scrollbar-thumb:hover {
        background: #2980b9;
    }
</style>

<div class="admin-sidebar">
    <div class="sidebar-header">
        <div class="sidebar-brand">
            <i class="fas fa-chart-line"></i>
            <span>FinMate Admin</span>
        </div>
        <div class="user-info">
            <div class="user-avatar">
                <i class="fas fa-user-shield"></i>
            </div>
            <div class="user-details">
                <div class="username"><%= user.username %></div>
                <div class="user-role">
                    <%= user.role === 'super_admin' ? 'Super Admin' : 'Admin' %>
                </div>
            </div>
        </div>
    </div>

    <nav class="sidebar-nav">
        <ul class="nav-links">
            <!-- Dashboard -->
            <li class="nav-item">
                <a href="/admin/dashboard" class="nav-link" id="nav-dashboard">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Dashboard</span>
                </a>
            </li>

            <!-- User Management -->
            <li class="nav-item">
                <a href="/admin/users" class="nav-link" id="nav-users">
                    <i class="fas fa-users"></i>
                    <span>User Management</span>
                </a>
            </li>

            <!-- Budget Management -->
            <li class="nav-item">
                <a href="/admin/budgets" class="nav-link" id="nav-budgets">
                    <i class="fas fa-wallet"></i>
                    <span>Budget Management</span>
                </a>
            </li>

            <!-- Expense Management -->
            <li class="nav-item">
                <a href="/admin/expenses" class="nav-link" id="nav-expenses">
                    <i class="fas fa-receipt"></i>
                    <span>Expense Management</span>
                </a>
            </li>

            <!-- Team Management -->
            <li class="nav-item">
                <a href="/admin/teams" class="nav-link" id="nav-teams">
                    <i class="fas fa-users-cog"></i>
                    <span>Team Management</span>
                </a>
            </li>

            <!-- Notifications -->
            <li class="nav-item">
                <a href="/admin/notifications" class="nav-link" id="nav-notifications">
                    <i class="fas fa-bell"></i>
                    <span>Notifications</span>
                </a>
            </li>

            <!-- Reports & Analytics -->
            <li class="nav-item">
                <a href="/admin/reports" class="nav-link" id="nav-reports">
                    <i class="fas fa-chart-bar"></i>
                    <span>Reports & Analytics</span>
                </a>
            </li>

            <!-- System Settings (Super Admin Only) -->
            <% if (user.role === 'super_admin') { %>
                <li class="nav-section">
                    <div class="section-label">System Administration</div>
                </li>
                
                <li class="nav-item">
                    <a href="/admin/system-settings" class="nav-link" id="nav-system-settings">
                        <i class="fas fa-cogs"></i>
                        <span>System Settings</span>
                    </a>
                </li>

                <li class="nav-item">
                    <a href="/admin/role-management" class="nav-link" id="nav-role-management">
                        <i class="fas fa-user-tag"></i>
                        <span>Role Management</span>
                    </a>
                </li>

                <li class="nav-item">
                    <a href="/admin/database" class="nav-link" id="nav-database">
                        <i class="fas fa-database"></i>
                        <span>Database Tools</span>
                    </a>
                </li>
            <% } %>

            <!-- Quick Actions Section -->
            <li class="nav-section">
                <div class="section-label">Quick Actions</div>
            </li>

            <li class="nav-item">
                <a href="/admin/expenses?filter=pending" class="nav-link">
                    <i class="fas fa-clock"></i>
                    <span>Pending Expenses</span>
                </a>
            </li>

            <li class="nav-item">
                <a href="/admin/users/add" class="nav-link">
                    <i class="fas fa-user-plus"></i>
                    <span>Add New User</span>
                </a>
            </li>

            <li class="nav-item">
                <a href="/admin/budgets/create" class="nav-link">
                    <i class="fas fa-plus-circle"></i>
                    <span>Create Budget</span>
                </a>
            </li>

            <!-- Navigation Links -->
            <li class="nav-section">
                <div class="section-label">Navigation</div>
            </li>

            <!-- <li class="nav-item">
                <a href="/dashboard" class="nav-link">
                    <i class="fas fa-home"></i>
                    <span>User Dashboard</span>
                </a>
            </li> -->

            <li class="nav-item">
                <a href="/admin/profile" class="nav-link">
                    <i class="fas fa-user"></i>
                    <span>My Profile</span>
                </a>
            </li>

            <li class="nav-item">
                <a href="/auth/logout" class="nav-link logout-link">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Logout</span>
                </a>
            </li>
        </ul>
    </nav>

    <div class="sidebar-footer">
        <div class="system-status">
            <div class="status-indicator online">
                <i class="fas fa-circle"></i>
                System Online
            </div>
            <div class="server-time" id="serverTime">
                Loading...
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Update server time
        function updateServerTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('en-US', {
                hour12: true,
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
            const dateString = now.toLocaleDateString('en-US', {
                weekday: 'short',
                year: 'numeric',
                month: 'short',
                day: 'numeric'
            });
            
            const timeElement = document.getElementById('serverTime');
            if (timeElement) {
                timeElement.innerHTML = `${dateString}<br>${timeString}`;
            }
        }
        
        // Update time immediately and then every second
        updateServerTime();
        setInterval(updateServerTime, 1000);
        
        // Highlight current page based on URL
        function highlightCurrentPage() {
            const currentPath = window.location.pathname;
            const navLinks = document.querySelectorAll('.nav-link');
            
            navLinks.forEach(link => {
                // Remove active class from all links
                link.classList.remove('active');
                
                // Check if this link's href matches current path
                const linkPath = link.getAttribute('href');
                if (currentPath === linkPath) {
                    link.classList.add('active');
                }
                
                // Also check for partial matches for nested routes
                if (currentPath.startsWith(linkPath) && linkPath !== '/' && linkPath !== '/dashboard') {
                    link.classList.add('active');
                }
            });
        }
        
        highlightCurrentPage();
    });
</script>